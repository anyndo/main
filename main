<?php include('koneksi.php')?>
<html>
    <head>
        <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Telkom Canteen</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
    </head>
    <body>
            <nav class="navbar navbar-expand-lg bg-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand text-white" href="#">Telkom Canteen</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarText" >
            <ul class="navbar-nav ms-auto">
                <li class="nav-item me-2">
                <a class="nav-link active text-white" aria-current="page" href="#about">About Kantin</a>
                </li>
                <li class="nav-item me-2">
                <a class="nav-link text-white" href="#cafetaria">Cafetaria List</a>
                </li>
                <li class="nav-item me-2">
                <a class="nav-link text-white" href="#buy">How To Buy</a>
                </li>
                <li class="nav-item me-5">
                <a class="nav-link text-white" href="#contact">Contact Us</a>
                </li>
            </ul>
            </div>
        </div>
        </nav>

        <section id="about" class="py-5 bg-light" style="padding-top: 70px !important;">
        <div class="container text-center">
            <h2 style="margin-top: 30px; margin-bottom: 50px;">About Us</h2>
            <div style="display: flex; align-items: center; justify-content: center; gap: 20px;">
              <img src="assets/Kantin.jpg" alt="GambarKantin" width="50%">
              <div style="text-align: left;">
                <h1 style="margin: 0;">Selamat Datang di Telkom Canteen</h1>
                <p style="margin: 0;">Kami menyediakan berbagai pilihan makanan dan minuman yang lezat dan terjangkau.</p>
              </div>
            </div>
            <div class="ratio ratio-16x9" style="margin-top: 90px;">
              <iframe width="150" height="50" src="https://www.youtube.com/embed/-E_HCGKQXBk?si=_9eFXbuAnOMW7CZB"
              title="YouTube video player" frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
              referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

            </div>
            <p style="margin-top: 40px;">Kantin SMK Telkom Jakarta adalah tempat yang selalu ramai dipenuhi tawa dan semangat siswa, bagaikan pusat energi di tengah-tengah gedung sekolah yang futuristik. Begitu melangkah masuk, aroma mie goreng dan nasi ayam bakar langsung menggoda indera penciuman, seolah mengajak setiap pengunjung untuk duduk sejenak dan melepas lelah. Meja-meja kayu yang tersusun rapi dipenuhi oleh murid-murid yang saling bertukar cerita sambil menyantap makanan favorit mereka. Dinding kantin dihiasi mural bergaya digital yang menggambarkan semangat inovasi dan teknologi, membuat suasana makan siang terasa seperti bagian dari petualangan di dunia siber. Dengan harga yang ramah di kantong pelajar dan suasana yang hangat, kantin ini bukan sekadar tempat makanâ€”melainkan ruang berkumpul, berbagi ide, dan membangun kenangan selama masa sekolah yang penuh warna.
            </p>
        </div>
    </section>

    <section id="cafetaria" class="py-5">
      <div class="container text-center">
        <h2 style="margin-top: 30px; margin-bottom: 40px;">Menu List</h2>

        <div class="row row-cols-1 row-cols-md-3 g-4">
          <div class="col">
            <div class="card h-100">
              <img src="assets/siomay.jpg" class="card-img-top" alt="siomay">
              <div class="card-body">
                <h5 class="card-title">Siomay (Warung Bu Rahma)</h5>
                <p class="card-text">Price: Rp 15.000</p>
              </div>
              <div class="card-footer">
                <small class="text-body-secondary">Stok: Displayed in "Buy Menu" section</small>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="card h-100">
              <img src="assets/siomay.jpg" class="card-img-top" alt="batagor">
              <div class="card-body">
                <h5 class="card-title">Batagor (Warung Bu Rahma)</h5>
                <p class="card-text">Price: Rp 15.000</p>
              </div>
              <div class="card-footer">
                <small class="text-body-secondary">Stok: Displayed in "Buy Menu" section</small>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="card h-100">
              <img src="assets/siomay.jpg" class="card-img-top" alt="Dimsum">
              <div class="card-body">
                <h5 class="card-title">Dimsum (Warung Bu Rahma)</h5>
                <p class="card-text">Price: 20.000</p>
              </div>
              <div class="card-footer">
                <small class="text-body-secondary">Stok: Displayed in "Buy Menu" section</small>
              </div>
            </div>
          </div>
        </div>

        <div class="row row-cols-1 row-cols-md-3 g-4 mt-3">
          <div class="col">
            <div class="card h-100">
              <img src="assets/indomie.jpg" class="card-img-top" alt="indomie">
              <div class="card-body">
                <h5 class="card-title">Indomie (Warung Pak Budi)</h5>
                <p class="card-text">Price: Rp 8.000</p>
              </div>
              <div class="card-footer">
                <small class="text-body-secondary">Stok: Displayed in "Buy Menu" section</small>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="card h-100">
              <img src="assets/teh.jpg" class="card-img-top" alt="teh">
              <div class="card-body">
                <h5 class="card-title">Teh (Warung Bu Titi)</h5>
                <p class="card-text">Price: Rp 5.000</p>
              </div>
              <div class="card-footer">
                <small class="text-body-secondary">Stok: Displayed in "Buy Menu" section</small>
              </div>
            </div>
          </div>

          <div class="col">
            <div class="card h-100">
              <img src="assets/jeruk.jpg" class="card-img-top" alt="jeruk">
              <div class="card-body">
                <h5 class="card-title">Es Jeruk (Warung Bu Titi)</h5>
                <p class="card-text">Price: 8.000</p>
              </div>
              <div class="card-footer">
                <small class="text-body-secondary">Stok: Displayed in "Buy Menu" section</small>
              </div>
            </div>
          </div>
        </div>

      </div> </section>


    <section id="buy" class="py-5 bg-light">
        <div class="container text-center">
            <h2 style="margin-bottom: 30px;"> Buy Menu </h2>

            <div class="row">
                <div class="col-md-4 mb-3">
                    <div class="card">
                        <img src="assets/siomay.jpg" class="card-img-top" alt="Siomay" width="320" height="320">
                        <div class="card-body">
                            <h5 class="card-title">Siomay (Warung Bu Rahma)</h5>
                            <p>Harga: Rp 15.000 - Stok: <span id="stock-display-1">30</span></p>
                            <form onsubmit="event.preventDefault(); showQRModal('Siomay', 15000, 1, this.qty.value)">
                                <input type="hidden" name="id_menu" value="1">
                                <input type="number" name="qty" id="qty-input-1" value="1" min="1" max="30" class="form-control mb-2" required>
                                <button type="submit" id="pesan-button-1" class="btn btn-primary w-100">Pesan</button>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-3">
                    <div class="card">
                        <img src="assets/siomay.jpg" class="card-img-top" alt="Batagor" width="320" height="320">
                        <div class="card-body">
                            <h5 class="card-title">Batagor (Warung Bu Rahma)</h5>
                            <p>Harga: Rp 15.000 - Stok: <span id="stock-display-2">30</span></p>
                            <form onsubmit="event.preventDefault(); showQRModal('Batagor', 15000, 2, this.qty.value)">
                                <input type="hidden" name="id_menu" value="2">
                                <input type="number" name="qty" id="qty-input-2" value="1" min="1" max="30" class="form-control mb-2" required>
                                <button type="submit" id="pesan-button-2" class="btn btn-primary w-100">Pesan</button>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-3">
                    <div class="card">
                        <img src="assets/siomay.jpg" class="card-img-top" alt="Dimsum" width="320" height="320">
                        <div class="card-body">
                            <h5 class="card-title">Dimsum (Warung Bu Rahma)</h5>
                            <p>Harga: Rp 20.000 - Stok: <span id="stock-display-3">30</span></p>
                            <form onsubmit="event.preventDefault(); showQRModal('Dimsum', 20000, 3, this.qty.value)">
                                <input type="hidden" name="id_menu" value="3">
                                <input type="number" name="qty" id="qty-input-3" value="1" min="1" max="30" class="form-control mb-2" required>
                                <button type="submit" id="pesan-button-3" class="btn btn-primary w-100">Pesan</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-md-4 mb-3">
                    <div class="card">
                        <img src="assets/indomie.jpg" class="card-img-top" alt="Indomie" width="320" height="320">
                        <div class="card-body">
                            <h5 class="card-title">Indomie (Warung Pak Budi)</h5>
                            <p>Harga: Rp 8.000 - Stok: <span id="stock-display-4">30</span></p>
                            <form onsubmit="event.preventDefault(); showQRModal('Indomie', 8000, 4, this.qty.value)">
                                <input type="hidden" name="id_menu" value="4">
                                <input type="number" name="qty" id="qty-input-4" value="1" min="1" max="30" class="form-control mb-2" required>
                                <button type="submit" id="pesan-button-4" class="btn btn-primary w-100">Pesan</button>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-3">
                    <div class="card">
                        <img src="assets/teh.jpg" class="card-img-top" alt="Teh" width="320" height="320">
                        <div class="card-body">
                            <h5 class="card-title">Teh (Warung Bu Titi)</h5>
                            <p>Harga: Rp 5.000 - Stok: <span id="stock-display-5">15</span></p>
                            <form onsubmit="event.preventDefault(); showQRModal('Teh', 5000, 5, this.qty.value)">
                                <input type="hidden" name="id_menu" value="5">
                                <input type="number" name="qty" id="qty-input-5" value="1" min="1" max="15" class="form-control mb-2" required>
                                <button type="submit" id="pesan-button-5" class="btn btn-primary w-100">Pesan</button>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-3">
                    <div class="card">
                        <img src="assets/jeruk.jpg" class="card-img-top" alt="Es Jeruk" width="320" height="320">
                        <div class="card-body">
                            <h5 class="card-title">Es Jeruk (Warung Bu Titi)</h5>
                            <p>Harga: Rp 8.000 - Stok: <span id="stock-display-6">15</span></p>
                            <form onsubmit="event.preventDefault(); showQRModal('Es Jeruk', 8000, 6, this.qty.value)">
                                <input type="hidden" name="id_menu" value="6">
                                <input type="number" name="qty" id="qty-input-6" value="1" min="1" max="15" class="form-control mb-2" required>
                                <button type="submit" id="pesan-button-6" class="btn btn-primary w-100">Pesan</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="qrModal" tabindex="-1" aria-labelledby="qrModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="qrModalLabel">QR Code Pembayaran</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Tutup"></button>
                    </div>
                    <div class="modal-body">
                        <p><strong id="namaMenu"></strong> x <span id="jumlahQty"></span></p>
                        <p>Total: <strong>Rp <span id="totalHarga"></span></strong></p>
                        <img id="qrImage" src="assets/qr.jpg" class="img-fluid" alt="QR Code">
                        <input type="hidden" name="id_menu_modal" id="modalIdMenu"> <input type="hidden" name="qty_modal" id="modalQty"> <button type="button" name="bayar" class="btn btn-success mt-3 w-100" onclick="processPaymentAndCloseModal()">Sudah Bayar</button>
                    </div>
                </div>
            </div>
        </div>
    </section> <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        var qrModalInstance;

        document.addEventListener('DOMContentLoaded', function () {
            var modalElement = document.getElementById('qrModal');
            if (modalElement) {
                qrModalInstance = new bootstrap.Modal(modalElement);
            }
        });

        function showQRModal(nama, harga, id, qty) {

            const qtyInput = document.getElementById('qty-input-' + id);
            const currentStock = parseInt(qtyInput.max);
            const requestedQty = parseInt(qty);

            if (requestedQty <= 0) {
                alert("Jumlah pembelian minimal 1.");
                return;
            }
            if (requestedQty > currentStock) {
                alert("Stok tidak mencukupi. Sisa stok: " + currentStock);
                qtyInput.value = currentStock; 
                return;
            }

            const total = harga * requestedQty;

            document.getElementById("namaMenu").textContent = nama;
            document.getElementById("jumlahQty").textContent = requestedQty;
            document.getElementById("totalHarga").textContent = total.toLocaleString("id-ID");
            document.getElementById("modalIdMenu").value = id;
            document.getElementById("modalQty").value = requestedQty;

            if (qrModalInstance) {
                qrModalInstance.show();
            }
        }

        function processPaymentAndCloseModal() {
            const menuId = document.getElementById("modalIdMenu").value;
            const quantityOrdered = parseInt(document.getElementById("modalQty").value);

            const stockDisplayElement = document.getElementById('stock-display-' + menuId);
            const qtyInputElement = document.getElementById('qty-input-' + menuId);
            const pesanButtonElement = document.getElementById('pesan-button-' + menuId);

            if (stockDisplayElement && qtyInputElement && pesanButtonElement) {
                let currentStock = parseInt(stockDisplayElement.textContent);
                let newStock = currentStock - quantityOrdered;

                if (newStock < 0) newStock = 0; // Prevent negative stock

                stockDisplayElement.textContent = newStock;
                qtyInputElement.max = newStock;


                if (parseInt(qtyInputElement.value) > newStock) {
                    qtyInputElement.value = newStock > 0 ? 1 : 0;
                }
                 if (newStock === 0) {
                    qtyInputElement.value = 0; 
                    qtyInputElement.disabled = true;
                    pesanButtonElement.disabled = true;
                    pesanButtonElement.textContent = "Stok Habis";
                } else {
                     qtyInputElement.disabled = false;
                     pesanButtonElement.disabled = false;
                     pesanButtonElement.textContent = "Pesan";
                     if (qtyInputElement.value == 0 && newStock > 0) {
                        qtyInputElement.value = 1;
                     }
                }
            } else {
                console.error("Could not find elements for menu ID: " + menuId);
            }

            if (qrModalInstance) {
                qrModalInstance.hide();
            }
        }
    </script>

    <section id="contact" class="py-5">
        <div class="container">
            <h2 style="text-center">Contact Us</h2>
            <form>
            <div class="mb-3">
                <label for="name" class="form-label">Nama</label>
                <input type="text" class="form-control" id="name" placeholder="Masukkan Nama" required>
            </div>
            <div class="mb-3">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" id="email" placeholder="Masukkan Email" required>
            </div>
            <div class="mb-3">
                <label for="pesan" class="form-label">Pesan</label>
                <textarea class="form-control" id="pesan" rows="3" placeholder="Tuliskan pesan yang kamu inginkan" required></textarea> 
            </div>
            <button class="btn btn-primary">Submit</button>
        </form>
    </div>
    </section>

        <footer class="text-center py-3 bg-dark text-white">
        <p>&copy; 2024 Zulfakhri Anindyo Putera. SMK Telkom Jakarta.</p>
    </footer>

    </body>
</html>
